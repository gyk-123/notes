import{_ as s,c as n,o as a,a as l}from"./app.6f8b5b75.js";const F=JSON.parse('{"title":"Jenkins","description":"","frontmatter":{},"headers":[],"relativePath":"jenkins/practice/index.md"}'),p={name:"jenkins/practice/index.md"},o=l(`<h1 id="jenkins" tabindex="-1">Jenkins <a class="header-anchor" href="#jenkins" aria-hidden="true">#</a></h1><p>\u521B\u5EFA\u9879\u76EE</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">create</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">react</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">app react</span><span style="color:#89DDFF;">-</span><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cicd</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u4F20\u81F3\u7801\u4E91\u4ED3\u5E93</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">git remote add origin git@gitee</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com:heora</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">react</span><span style="color:#89DDFF;">-</span><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cicd</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">git</span></span>
<span class="line"><span style="color:#A6ACCD;">git push </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">u origin master</span></span>
<span class="line"></span></code></pre></div><p>\u5B89\u88C5 JDK</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">cd </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">local</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">src</span></span>
<span class="line"><span style="color:#A6ACCD;">wget </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//img.zhufengpeixun.cn/jdk1.8.0_211.tar.gz</span></span>
<span class="line"><span style="color:#A6ACCD;">tar </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">xzvf jdk1</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">8.0_211</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz</span></span>
<span class="line"><span style="color:#A6ACCD;">mkdir </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java</span></span>
<span class="line"><span style="color:#A6ACCD;">cp </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">r jdk1</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">8.0_211</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java</span></span>
<span class="line"><span style="color:#A6ACCD;">ln </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">jdk1</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">8.0_211</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ll </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">java </span><span style="color:#676E95;font-style:italic;">// \u67E5\u770B\u8F6F\u8FDE\u63A5\u662F\u5426\u8FDE\u63A5\u6210\u529F</span></span>
<span class="line"></span></code></pre></div><p>\u5B89\u88C5 jenkins</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">wget </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">O </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">yum</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">repos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">jenkins</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">repo </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//pkg.jenkins.io/redhat-stable/jenkins.repo</span></span>
<span class="line"><span style="color:#A6ACCD;">rpm </span><span style="color:#89DDFF;">--</span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> https:</span><span style="color:#676E95;font-style:italic;">//pkg.jenkins.io/redhat-stable/jenkins.io.key</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install -y jenkins</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B jenkins \u8FD0\u884C\u72B6\u6001</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">systemctl status jenkins </span><span style="color:#676E95;font-style:italic;">// \u67E5\u770B jenkins \u8FD0\u884C\u72B6\u6001</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl start jenkins </span><span style="color:#676E95;font-style:italic;">// \u542F\u52A8 jenkins</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;">/lib/jenkins/secrets/initialAdminPassword </span><span style="color:#676E95;font-style:italic;">// jenkins \u5BC6\u7801</span></span>
<span class="line"></span></code></pre></div><p>\u4FEE\u6539\u63D2\u4EF6\u955C\u50CF\u5730\u5740</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// \u63D2\u4EF6\u7BA1\u7406 - \u9AD8\u7EA7 - \u5347\u7EA7\u7AD9\u70B9</span></span>
<span class="line"></span></code></pre></div><p>\u914D\u7F6E\u53EF\u9009\u63D2\u4EF6</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">Generic Webhook Trigger </span><span style="color:#676E95;font-style:italic;">// Trigger web \u89E6\u53D1\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">Publish Over SSH	</span><span style="color:#676E95;font-style:italic;">// \u901A\u8FC7 SSH \u90E8\u7F72\u670D\u52A1\u5668</span></span>
<span class="line"><span style="color:#A6ACCD;">nvm wrapper </span><span style="color:#676E95;font-style:italic;">// \u63D0\u4F9B node \u73AF\u5883</span></span>
<span class="line"></span></code></pre></div><p>\u5173\u95ED\u9632\u706B\u5899</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">systemctl status firewalled</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service </span><span style="color:#676E95;font-style:italic;">// \u67E5\u770B\u9632\u706B\u5899\u72B6\u6001</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl stop firewalled</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl disable firewalled</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"></span></code></pre></div><p>\u914D\u7F6E webhook</p><ul><li>jenkins</li></ul><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 1. \u521B\u5EFA\u9879\u76EE</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 2. \u914D\u7F6E Git\uFF08\u6E90\u7801\u7BA1\u7406\uFF09</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3. \u6784\u5EFA\u89E6\u53D1\u5668 Generic Webhook Trigger </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 4. \u5E94\u7528</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 5. \u8BBE\u7F6E - \u6DFB\u52A0 API Token</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7801\u4E91</li></ul><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// \u9879\u76EE\u7BA1\u7406 - WebHooks</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// \u6DFB\u52A0 hooks\uFF08http://username:token@\uFF08IP\u5730\u5740 | \u57DF\u540D\uFF09\uFF09/ \u9879\u76EE\u540D\u79F0/invoke</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// -- http://username:token@jenkins.yueluo.club/generic-webhook-trigger/invoke</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// \u6DFB\u52A0\u914D\u7F6E</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// \u6D4B\u8BD5 webhook\uFF08\u4E0A\u4F20\u4EE3\u7801\u6D4B\u8BD5\u3001webhook\u6D4B\u8BD5\uFF09</span></span>
<span class="line"></span></code></pre></div><p>\u6784\u5EFA\u9879\u76EE - \u6784\u5EFA\u73AF\u5883</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// -- \u52FE\u9009\uFF08Run the build in an NVM managed environment\uFF09</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// -- \u7F16\u5199 NVM Settings\uFF08\u53EA\u586B\u5199 node \u7248\u672C\u5373\u53EF\uFF09</span></span>
<span class="line"></span></code></pre></div><p>\u589E\u52A0\u6784\u5EFA\u6B65\u9AA4\uFF08\u6267\u884Cshell\uFF09</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">npm config set registry </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//registry.npm.taobao.org</span></span>
<span class="line"><span style="color:#A6ACCD;">npm install</span></span>
<span class="line"><span style="color:#A6ACCD;">rm </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">rf build</span></span>
<span class="line"><span style="color:#A6ACCD;">npm run build</span></span>
<span class="line"></span></code></pre></div><p>\u6784\u5EFA\u6210\u529F\u540E\uFF0C\u53EF\u4EE5\u53E6\u9009\u670D\u52A1\u5668\u914D\u7F6E nginx \u90E8\u7F72\u9879\u76EE\uFF0C\u4E5F\u53EF\u4EE5\u9009\u62E9\u672C\u673A\u90E8\u7F72\u3002</p><p>\u8FFD\u52A0\u6784\u5EFA\u811A\u672C</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">cd build</span></span>
<span class="line"><span style="color:#A6ACCD;">tar </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">zcvf build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">cp build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">www</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">react</span><span style="color:#89DDFF;">-</span><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cicd</span></span>
<span class="line"><span style="color:#A6ACCD;">cd </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">www</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">react</span><span style="color:#89DDFF;">-</span><span style="color:#89DDFF;font-style:italic;">with</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">cicd</span></span>
<span class="line"><span style="color:#A6ACCD;">tar </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">xzvf build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz</span></span>
<span class="line"><span style="color:#A6ACCD;">rm </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">rf build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tar</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">gz</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">chown </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">R jenkins </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">www </span><span style="color:#676E95;font-style:italic;">// \u5982\u679C\u63D0\u793A\u6743\u9650\u4E0D\u591F\uFF0C\u53EF\u4EE5\u624B\u52A8\u8D4B\u4E88 jenkins \u6743\u9650</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u8FF0\u811A\u672C\u64CD\u4F5C\u7684\u662F\u672C\u673A\u90E8\u7F72\u7A0B\u5E8F\uFF0C\u5C06\u6253\u5305\u540E\u7684\u6587\u4EF6\u79FB\u52A8\u81F3\u914D\u7F6E\u597D\u7684 nginx \u76EE\u5F55\u3002<br> \u5982\u679C\u9009\u62E9\u5176\u4ED6\u670D\u52A1\u5668\u90E8\u7F72\uFF0C\u9700\u8981\u914D\u7F6E SSH \u514D\u767B\u5F55\u7B49\u529F\u80FD\uFF0C\u8FD9\u91CC\u5C31\u4E0D\u6F14\u793A\u4E86\u3002</p><p>jenkins \u4FEE\u6539\u542F\u52A8\u7528\u6237\uFF0C\u811A\u672C\u6267\u884C\u6743\u9650\u95EE\u9898</p><ul><li>\u5C06 jenkins \u8D26\u53F7\u5206\u522B\u52A0\u5165\u5230 root \u7EC4\u4E2D</li></ul><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">gpasswd </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">a root jenkins</span></span>
<span class="line"></span></code></pre></div><ul><li>\u4FEE\u6539 /etc/sysconfig/jenkins \u6587\u4EF6</li></ul><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># user id to be invoked </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> (</span><span style="color:#FFCB6B;">otherwise</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">will</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;">; </span><span style="color:#FFCB6B;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">wise</span><span style="color:#A6ACCD;">!)</span></span>
<span class="line"><span style="color:#A6ACCD;">JENKINS_USER</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">root</span></span>
<span class="line"><span style="color:#A6ACCD;">JENKINS_GROUP</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">root</span></span>
<span class="line"></span></code></pre></div><ul><li>root \u6743\u9650\u91CD\u65B0\u542F\u52A8</li></ul><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">service Jenkins restart</span></span>
<span class="line"></span></code></pre></div>`,37),e=[o];function c(t,r,i,y,D,C){return a(),n("div",null,e)}var d=s(p,[["render",c]]);export{F as __pageData,d as default};
